\documentclass[
11pt,
a4paper,
ngerman,
]{article}

\usepackage{babel}	%übersetzt die englischen überschriften ins deutche
					% damit sind \tableofcontents und co gemeint

\usepackage[ngerman]
\usepackage[utf8]{inputenc}
\usepackage[demo]{graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{array}
\usepackage{lastpage}
\usepackage{lipsum}
\usepackage{currfile}
\usepackage{tabularx}
\usepackage{fancyhdr}
\usepackage{colortbl}
\usepackage{enumitem}
\usepackage{ulem}

\usepackage[textwidth=3.5cm,prependcaption]{todonotes}

\usepackage{float}			% für den text fluss um figures und tables

\usepackage[
   hmargin=2cm,
   right=4.3cm,  %remove if no more todos active
   top=4cm,
   bottom=4.5cm,
   headheight=65pt,
   footskip=50pt,
   marginparwidth=70pt
]{geometry}


\setlength{\parindent}{0.95cm}

% set a sans serif typo
%\renewcommand{\familydefault}{\sfdefault}

%comments talk
\newcommand{\commentKayo}[1]{\todo[size=\small,color=green!40,author=Kayo]{#1}}
\newcommand{\commentHeiko}[1]{\todo[size=\small,color=blue!30,author=Heiko]{#1}}
\newcommand{\commentMark}[1]{\todo[size=\small,color=red!90!green!30,author=Mark]{#1}}
\newcommand{\commentPhil}[1]{\todo[size=\small,color=red!35!blue!40,author=Phillip]{#1}}

%
\newcommand{\rem}[1]{\textcolor{red}{\sout{#1}}}
\newcommand{\add}[1]{\textcolor{blue}{\uline{#1}}}

\newcommand{\descriptionWhat}[1]{%
	\begin{itshape}%
	#1 \\%
	\end{itshape}%
}

%%%%%%%%%%%%%%%%%%%%%%%
%% set doc header
%%%%%%%%%%%%%%%%%%%%%%%
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\fancyhead[CE,CO,LE,LO,RE,RO]{} %% clear out all headers
\fancyhead[C]{%
	\begin{tabularx}{\columnwidth}{|X|X|r|}
		\hline
		Unternehmen & \centering ID 4 & \centering Klare sicht im Kupfergraben
		\tabularnewline
		\hline
		\multicolumn{2}{|c|}{} & 22.06.2017 \\
		\hline
		\multicolumn{2}{|l|}{ \currfilename } & \thepage\ of \pageref*{LastPage} \\
		\hline
	\end{tabularx}%
}

%%%%%%%%%%%%%%%%%%%%%%%
%% set doc footer
%%%%%%%%%%%%%%%%%%%%%%%
\fancyfoot[CE,CO,LE,LO,RE,RO]{} %% clear out all footers
\fancyfoot[L]{%
	\noindent\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}
	Das Werk einschließlich aller seiner Teile ist urheberrechtlich geschützt. Jede Verwertung außerhalb der engen Grenzen des Urheberrechtsgesetzes ist ohne Zustimmung des Verfassers unzulässig und strafbar.
}

%set global table cell style
\setlength{\tabcolsep}{8pt} % Default value: 6pt
\renewcommand{\arraystretch}{1.3} % Default value: 1

%%%%%%%%%%%%%%%%%%%%%%%
%% Document
%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

% set title page
\begin{titlepage}
{ %
	\begingroup
	\hbox{ % Horizontal box
		\parbox[b]{1.1\textwidth}{ % Paragraph box which restricts text to less than the width of the page
			{\noindent\Huge\bfseries Pflichtenheft \\[0.2\baselineskip] } % Title
			{\large Projekt-ID 4 }\\[3\baselineskip] % Tagline or further description
			{\noindent\Huge\bfseries Klare Sicht im Kupfergraben \\[.5\baselineskip] }
			{\Large {Bestimmung der Wasserqualität mit Hilfe von Messtationen auf LoRaWAN-Basis}}
		}%
	}%
	\endgroup%
}%
\end{titlepage}


\tableofcontents
\listoffigures
\listoftables

\newpage

%% add this if you want the fancy style also on the first page of a chapter:
%\thispagestyle{fancy}

\input{einleitung.tex}

\section{Beschreibung der Ausgangssituation}

\subsection{Kurzbeschreibung der Ausgangssituation}

\descriptionWhat{Ausgangssituation, IST-Situation (aus \glqq Lösersicht\grqq{}; unter Anreicherung mit \glqq Zielkontextwissen\grqq{})}

Ein Node kann durch einen Gateway über The Things Network kommunizieren, welches auf die Technologie LoRaWAN aufbaut. LoRaWAN ist ein funkbasiertes Netzwerkdesign, welches es ermöglicht energiesparend Daten zu versenden. TTN stellt eine Schnittstelle zum Internet bereit und vereinfacht dadurch die Weiterleitung der Messdaten an externe Dienste/Server. Die über LoRaWAN an TTN gesendeten Daten werden bis zum Abruf dieser, jedoch maximal 7 Tage, zwischengespeichert, wenn ihre „Storage Integration“ verwendet wird.
Gateways sind freiwillig au

\subsection{Auftraggeber}

\descriptionWhat{Einordnendes Profil des Auftraggebers aus \glqq Lösersicht\grqq{}}

Bereits seit 2014 beteiligt die TSB sich aktiv an der Förderung der Strategie bezüglich der offenen Daten in Berlin mit verschiedenen Unternehmen, Behörden und Instituten.
Im Rahmen von einem solcher Projekte organisierte sie bereits am 05.05.2017 das erste \glqq LoRaWAN-Treffen\grqq{}  in Zusammenarbeit mit The Things Network Berlin, wobei eine Plattform der Begegnung für viele Interessanten geschafft wurde, in der sie eigene Gedanken miteinander austauschen konnten.
Des Weiteren hält sie am 23.05.2017 das zweite Treffen, in dem sie weitere Möglichkeiten der Anwendungsfälle vorstellen wird, damit die Interessanten sich vernünftig mit der LoRaWAN-Technik beschäftigen können.
Trotz der Behandlung der sensiblen Umweltdaten in der Stadt sollte das Projekt von der TSB durch ihre eigene Kontakt zu den Behörden und anderen Einrichtungen stark unterstützt werden.
Zu den direkt Beteiligten an diesem Projekt gehören Dr. Christian Hammel, Dr. Benjamin Seibel und Sebastian Rauer.

\subsection{Zielbeschreibung}

\descriptionWhat{Fachliche Zielinterpretation aus Sicht der Umsetzung (ohne technische Umsetzungsbeschreibung), angenommener sachlicher Effekt usw.}

Es sollen robuste und wartungsarme Messstationen zu Umweltdaten entstehen. Diese Messstationen werden am Kupfergraben und der Spree betrieben, um die Wasserqualität im Kontext des Testfilters des Vereins Flussbad Berlin zu messen. \commentKayo{In Anlass  und Glossar umschreiben}Der Verein tritt dafür ein ein Flussbad am Kupfergraben, auf Höhe des Lustgartens, zu errichten. Zur dafür nötigen Verbesserung der Wasserqualität im Kupfergraben ist der Betrieb einer Filteranlage notwendig, ein Prototyp dieser wird zeitnah \commentKayo{Noch genauer. Juli?} in Betrieb genommen werden. Die Veränderung der Wasserqualität durch diesen Prototypen soll mit den Sensoren unserer Messstationen gemessen werden. Hierfür ist es zusätzlich notwendig, dass ein Gehäuse entworfen wird, welches den Umwelteinflüssen am Kupfergraben standhält.\\
Die Messstation wird die Messdaten über ein Gateway an TTN versenden. Ein Datenbankserver muss über eine der Schnittstellen von TTN die Daten \commentKayo{Genauere Beschreibung benötigt.}regelmäßig laden und in der eigenen Datenbank speichern. Die Serversoftware und die Datenbank müssen so umgesetzt werden, dass es für Dritte einfach möglich ist die Messdaten abzurufen.

\newpage

\input{anforderungen.tex}

\newpage

\section{Fachliche Konzeption}

\descriptionWhat{Vollständige Umsetzungsbeschreibung der konkreten Lösung}

\subsection{z.B. Ziel- Nutzergruppe}

\descriptionWhat{Zielgruppendefinition}

Primäre Zielgruppen sind die Technoligiestiftung Berlin (TSB) und der Verein Flussbad Berlin (VFB). Des weiteren  sind die erhobenen Daten für Dritte zugänglich und relevant. Die TSB ist als Auftraggeber von besonderer Bedeutung, das fertige Produkt muss ihren Anforderungen entsprechen. Der VFB ist als Partner für die Messstandorte besonders für die Erprobungsphase wichtig. Der Prototyp muss eventuell auch an die Gegebenheiten des vom VFB zur Verfügung gestellten Standortes angepasst werden.

\subsection{z.B. Inhaltlicher Aufbau/Komponenten}

\descriptionWhat{Dokumentenstruktur, Web-Seitenstruktur, Seitenstruktur Bauteile, Konstruktionspläne}

\newpage

\section{Entwicklungs- und Produktionsrahmenbedingungen}

Die Messstationen bestehen im Kern aus einem Arduino Uno sowie dem Dragino-Shield. Daran angeschlossen werden die Sensoren zur Messung der Wasserqualität. Auf jeden Fall müssen ein pH-Wert, ein Wassertrübheits-, sowie ein Wassertemperatursensor vorhanden sein. Optional zur Bestimmung der Wasserqualität sind ein Leitfähigkeitssensor und ein Sensor zur Bestimmung der Menge des im Wasser gelösten Sauerstoffs. Auch wird ein geeignetes Gehäuse für die Station benötigt.
Aufgrund der mangelhaften Funknetzstärke an dem Messorten muss noch mind. Ein TTN Gateway installiert werden. Der geplante Standort ist der Versuchsfilter des Vereins Flussbad Berlin. Die benötigte Hardware wird duch die Technologiestiftung Berlin gestellt.
Softwareseitig wird eine Komponente zum Abgreifen der Messdaten aus dem TTN, ein Datenbanksystem für die Speicherung (Software auf dem Datenbankserver), eine Web-Applikation zum Anzeigen, sowie eine Schnittstelle (API) zum erweiterten Zugriff auf die Messdaten. Die Messinstrumente werden durch zu entwickelnde Software auf dem Arduino ausgewertet, diese Messdaten werden anschließend an TTN versendet.
Technisch begrenzt werden die Messstationen vom Energieverbrauch sowie der Datenrate bei TTN. Für das benutzte (freie) 868MHz Funkband besteht die Sendezeitbegrenzung von max. 1\% einer Stunde von Seiten der Bundesnetzagentur.
Finanzielle Grenzen sind dem Projekt von Seiten des Budgets der TSB gesetzt.

\input{schnittstellen.tex}

\newpage

\section{Risiken}

\newpage

\section{Einverständnis-Erklärung}

Die Parteien bestätigen, dass der Inhalt dieses Pflichtenheftes die jeweiligen vertraglichen Verpflichtungen darstellt. Es besteht gemeinsames Einverständnis, dass das Pflichtenheft im Laufe des Projektes einvernehmlich schriftlich geändert werden kann.

\begin{table}[H]
	\begin{tabularx}{\textwidth}{ |m{2cm}Xm{1.2cm}X| }
		\hline
		\multicolumn{4}{|c|}{} \\
		\multicolumn{4}{|c|}{} \\
		Unterschrift: & \makebox[0.3\columnwidth]{\dotfill} & Datum: & \makebox[0.3\columnwidth]{\dotfill} \\
		\multicolumn{4}{|c|}{} \\
		Name: & \makebox[0.3\columnwidth]{\dotfill} & \multicolumn{2}{c|}{} \\
		\multicolumn{4}{|c|}{} \\
		\multicolumn{4}{|c|}{} \\
		Unterschrift: & \makebox[0.3\columnwidth]{\dotfill} & Datum: & \makebox[0.3\columnwidth]{\dotfill} \\
		\multicolumn{4}{|c|}{} \\
		Name: & \makebox[0.3\columnwidth]{\dotfill} & \multicolumn{2}{c|}{} \\
		\multicolumn{4}{|c|}{} \\
		\multicolumn{4}{|c|}{} \\
		Unterschrift: & \makebox[0.3\columnwidth]{\dotfill} & Datum: & \makebox[0.3\columnwidth]{\dotfill} \\
		\multicolumn{4}{|c|}{} \\
		Name: & \makebox[0.3\columnwidth]{\dotfill} & \multicolumn{2}{c|}{} \\
		\multicolumn{4}{|c|}{} \\
		\multicolumn{4}{|c|}{} \\
		Unterschrift: & \makebox[0.3\columnwidth]{\dotfill} & Datum: & \makebox[0.3\columnwidth]{\dotfill} \\
		\multicolumn{4}{|c|}{} \\
		Name: & \makebox[0.3\columnwidth]{\dotfill} & \multicolumn{2}{c|}{} \\
		\multicolumn{4}{|c|}{} \\
		\multicolumn{4}{|c|}{} \\
		\hline
	\end{tabularx}
\end{table}
\end{document}
